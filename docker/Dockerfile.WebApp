FROM mcr.microsoft.com/dotnet/aspnet:8.0

WORKDIR /app
EXPOSE 80
EXPOSE 443

ARG USERNAME=appuser
ARG USER_UID=1000
ARG USER_GID=$USER_UID

RUN groupadd -g "$USER_GID" "$USERNAME" && \
	useradd -m -u "$USER_UID" -g "$USER_GID" "$USERNAME"


RUN chown -R "$USERNAME:$USERNAME" /app

ARG SOURCE_FOLDER
COPY ${SOURCE_FOLDER} . 

USER "$USERNAME"
ENTRYPOINT ["dotnet", "BlazorDemo.WebApp.dll"]

ENV ASPNETCORE_HTTP_PORTS=80
ENV DOTNET_SYSTEM_NET_HTTP_USESSL=false
